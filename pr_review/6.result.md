# PR #6 메인테이너 의견

PR 제출해 주셔서 감사합니다. 명령어별 권한 관리 체계를 도입하는 것 자체는 환영합니다. 현재 설계에 대해 몇 가지 의견을 드립니다.

---

## 1. 위험도 분류 방식에 대하여

현재 PR은 명령어를 Safe / Elevated / Dangerous 3단계로 분류하고, `!` 쉘 명령어를 일반 텍스트 프롬프트보다 높은 위험도로 취급하고 있습니다.

그러나 쉘 명령어와 일반 프롬프트는 본질적으로 같은 수준의 위험도를 가진다고 봅니다. AI에게 자연어로 요청하는 것과 쉘 명령어를 직접 실행하는 것은 결과적으로 동일한 작업을 수행할 수 있기 때문입니다. 이 둘을 다른 위험도로 구분하는 것은 실질적인 보안 효과보다는 착시를 만들 수 있습니다.

## 2. 명령어 내용 기반 위험도 판정의 한계

명령어의 종류나 인자를 기계적으로 분석하여 위험도를 판정하는 접근은 충분하지 않다고 생각합니다. 명령어는 다양한 조합으로 다양한 의미를 만들어낼 수 있으며, 이를 정적으로 판단하는 것은 매우 어려운 일입니다. 예를 들어 파이프, 리다이렉션, 변수 치환, 별칭 등을 고려하면 단순한 패턴 매칭으로는 실제 위험도를 정확히 반영하기 어렵습니다.

따라서 "이 명령어는 위험하고 저 명령어는 안전하다"는 식의 내용 기반 분류보다는, **명령어 자체를 하나의 기능 단위로 보고 해당 기능에 대한 접근 권한을 관리하는 방식**이 더 적절합니다.

## 3. 고정적 계급별 권한 부여의 확장성 문제

현재 PR의 권한 매트릭스는 Owner / Public 비소유자 / 일반 비소유자라는 고정된 계급에 고정된 권한을 부여합니다. 이 구조는 단순하고 명확하지만, 향후 요구사항 변화에 유연하게 대응하기 어렵습니다.

예를 들어 "특정 그룹에서는 비소유자에게도 `/start`를 허용하고 싶다"거나 "특정 명령어만 추가로 열어주고 싶다"는 요구가 생겼을 때, 현재 구조로는 코드를 수정해야 합니다.

기존에 이미 구현되어 있는 `/allowed` 명령어와 같은 방식이 더 좋은 모델이 될 수 있습니다. 계급(역할)별로 허용되는 명령어 목록을 런타임에 관리할 수 있는 구조가 확장성과 유연성 면에서 훨씬 나은 구조라고 생각합니다.

---

## 요약

| 항목 | 현재 PR | 의견 |
|------|---------|------|
| 위험도 분류 | 명령어 내용 기반 3단계 | 불필요 — 명령어 기능 단위로 권한 관리가 더 적절 |
| 쉘 vs 프롬프트 | 쉘이 더 위험 | 동일한 위험도 |
| 권한 부여 | 계급별 고정 | `/allowed` 방식의 유연한 관리가 더 적합 |
| 확장성 | 코드 수정 필요 | 런타임 설정으로 조정 가능한 구조가 바람직 |

전체적인 방향성(명령어별 권한 관리 도입)에는 동의합니다. 좋은 기여 감사드립니다.
